str(fit.marginal$vv)
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
joint
fit.joint <- list()
fit.joint$vv <-list()
fit.joint$vv$ER<-corHMM(eel.tree,eel.data,node.states="joint",
rate.cat=1,rate.mat=matrix(c(NA,1,1,NA),2,2))
fit.joint$vv$ARD1<-corHMM(eel.tree,eel.data,node.states="joint",
rate.cat=1,rate.mat=matrix(c(NA,1,2,NA),2,2))
fit.joint$vv$irrever10<-corHMM(eel.tree,eel.data,node.states="joint",
rate.cat=1,rate.mat=matrix(c(NA,0,1,NA),2,2))
fit.joint$vv$irrever01<-corHMM(eel.tree,eel.data,node.states="joint",
rate.cat=1,rate.mat=matrix(c(NA,1,0,NA),2,2),root.p=c(0.5,0.5))
fit.joint$vv
str(fit.joint$vv)
str(fit.joint$vv$ER)
fit.joint$vv$ER$states
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
as.Qmatrix.corhmm<-function(x,level,...){
Q<-x$solution
Q[which(is.na(Q))] <- 0
diag(Q)<--rowSums(Q,na.rm=TRUE)
class(Q)<-"Qmatrix"
colnames(Q) <- levels(level)
row.names(Q) <- levels(level)
Q
}
fit.marginal
str(fit.marginal$vv)
fit.marginal$vv[1]
fit.marginal$vv[[1]]
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
fit.joint$vv
str(fit.joint$vv$ER)
to.matrix(fit.joint$vv$ER,1:2)
to.matrix(fit.joint$vv$ER$states,1:2)
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
BM <-anc.ML(tree, x1, maxit=20, model='BM')
tree <- readRDS("Documents/Paper.in.prep/Interface.gamma/GAMMA/data/anoletree.RDS")
data <-readRDS("Documents/Paper.in.prep/Interface.gamma/GAMMA/data/anole.data.RDS")
x1 <-setNames(data$SVL,row.names(data))
BM <-anc.ML(tree, x1, maxit=20, model='BM')
BM
BM$ace
map <-contMap(tree, x,method='user', anc.states= c(x1,v$Models$BM$ace) )
x1
map <-contMap(tree, x1,method='user', anc.states= c(x1,v$Models$BM$ace) )
tree <- readRDS("Documents/Paper.in.prep/Interface.gamma/GAMMA/data/anoletree.RDS")
c(x1,v$Models$BM$ace)
map <-contMap(tree, x1,method='user', anc.states= c(x1,v$Models$BM$ace) )
v$Models$BM$ace
map <-contMap(tree, x1,method='user', anc.states= c(x1,BM$ace) )
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
shiny::runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
shiny::runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
mtree<-make.simmap(eel.tree,feed.mode,model="ER")
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
fit.joint$vv[[1]]
fit.joint$vv[[1]]$states
to.matrix(fit.joint$vv[[1]]$states)
to.matrix(c(0,1),fit.joint$vv[[1]]$states)
to.matrix(fit.joint$vv[[1]]$states,c(0,1))
m <- to.matrix(fit.joint$vv[[1]]$states,c(0,1))
row.names(m) < - fit.joint$vv[[1]]$states,c(0,1)
row.names(m) < - fit.joint$vv[[1]]$states
fit.joint$vv[[1]]$states
row.names(m)
m <- to.matrix(fit.joint$vv[[1]]$states,c(0,1))
m
row.names(m) < - fit.joint$vv[[1]]$states
row.names(m)
m
fit.joint$vv[[1]]$states
row.names(m) < - fit.joint$vv[[1]]$states
m <- to.matrix(fit.joint$vv[[1]]$states,c(1,0))
m
m
m <- to.matrix(fit.joint$vv[[1]]$states,1:2)
m <- to.matrix(fit.joint$vv[[1]]$states,1:2)
m
xx <-read.csv('Documents/Paper.in.prep/Interface.gamma/LibroLiam/Data-Example Book/with3states.csv',header = T,row.names=1)
which.max(c(1,3,3))
c(1,3,3)
which.max(c(1,4,3))
which.max(c(1,2,3))
which.max(c(5,2,3))
which.max(c(5,5,3))
max(c(5,5,3))
d <- c(5,5,3)
which(d == max(d))
data.frame('col1' = sample(c(1:5),10),'col2' = sample(c(1:5),10),'col3' = sample(c(1:5),10))
data.frame('col1' = sample(c(1:5),10,replace = T),'col2' = sample(c(1:5),10,replace = T),'col3' = sample(c(1:5),10,replace = T))
d <-data.frame('col1' = sample(c(1:5),10,replace = T),'col2' = sample(c(1:5),10,replace = T),'col3' = sample(c(1:5),10,replace = T))
nn <- apply(d,1, function(x) which(x == max(x)))
nn
d
nn <- apply(d,1, function(x) d[,which(x == max(x)) <- 1])
d[,which(x == max(x))]
nn <- apply(d,1, function(x) d[,which(x == max(x))] <-)
nn <- apply(d,1, function(x) d[,which(x == max(x))] <-1)
nn
d <-data.frame('col1' = sample(c(1:5),10,replace = T),'col2' = sample(c(1:5),10,replace = T),'col3' = sample(c(1:5),10,replace = T))
nn <- apply(d,1, function(x) d[,which(x == max(x))] <-1)
nn
d <-data.frame('col1' = sample(c(1:5),10,replace = T),'col2' = sample(c(1:5),10,replace = T),'col3' = sample(c(1:5),10,replace = T))
nn <- apply(d,1, function(x) d[,which(x == max(x))])
nn
d
nn <- lapply(d, function(x) d[,which(x == max(x))])
nn <- lapply(d, function(x) which(x == max(x)))
nn
nn <- sapply(d, function(x) which(x == max(x)))
nn
nn <- apply(d, 1,function(x) which(x == max(x)))
nn
d <-data.frame('col1' = sample(c(1:5),10,replace = T),'col2' = sample(c(1:5),10,replace = T),'col3' = sample(c(1:5),10,replace = T))
d
nn
nn[[1]]
nn[[3]]
for (i in 1:length(nn)) {
d[i,nn[[i]] <- 1
}
for (i in 1:length(nn)) {
d[i,nn[[i]]] <- 1
}
d
d <-data.frame('col1' = sample(c(1:5),10,replace = T),'col2' = sample(c(1:5),10,replace = T),'col3' = sample(c(1:5),10,replace = T))
ncol(d)
d[,1:ncol(d)] <- 0
d
for (i in 1:length(nn)) {
d[i,nn[[i]]] <- 1
}
d
nn
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
data <-read.csv("../LibroLiam/Data-Example Book/with3states.csv")
data <-read.csv("../LibroLiam/Data-Example Book/with3states.csv")
data <-read.csv("../LibroLiam/Data-Example Book/with3states.csv")
data <-read.csv("../LibroLiam/Data-Example Book/with3states.csv")
data <-read.csv("Documents/Paper.in.prep/Interface.gamma/LibroLiam/Data-Example Book/with3states.csv")
data
setNames(data$simul,eel.tree$tip.label)
data3states <- setNames(data$simul,eel.tree$tip.label)
eel.data<-data.frame(Genus_sp=names(data3states),
state3=as.numeric(data3states)-1)
fit.joint$vv$ER<-corHMM(eel.tree,eel.data,node.states="joint",
rate.cat=1,rate.mat=matrix(c(NA,1,1,NA),2,2))
matrix(c(NA,1,1,NA),3,3)
fit.joint$vv$ER<-corHMM(eel.tree,eel.data,node.states="joint",
rate.cat=1,rate.mat=matrix(c(NA,1,1,1,NA,1,1,1,NA),3,3))
fit.joint$vv$ER
fit.joint$vv$ER$states
levels(data3states)
data3states
Genus_sp=names(data3states)
as.numeric(data3states)
to.matrix(fit.joint$vv$ER$states,1:length(levels(as.factor(data3states))))
fit.joint$vv$ER$states
to.matrix(fit.joint$vv$ER$states,1:length(levels(as.factor(data3states))))
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
shiny::runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
shiny::runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp()
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
runApp('Documents/Paper.in.prep/Interface.gamma/GAMMA')
setwd("~/Documents/Paper.in.prep/Interface.gamma/GAMMA")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
mtree<-make.simmap(eel.tree,feed.mode,model="ER")
## plot single stochastic map
plot(mtree,cols,fsize=0.4,ftype="i",lwd=2,offset=0.4,
ylim=c(-1,Ntip(eel.tree)))
## add legend
legend("bottomleft",legend=levels(feed.mode),pch=22,
pt.cex=1.5,pt.bg=cols,bty="n",cex=0.8)
mtree<-make.simmap(eel.tree,feed.mode,model="ARD")
mtree
mtree<-make.simmap(eel.tree,feed.mode,model=matrix(c(NA,1,0,NA),2,2))
feed.mode
mtree<-make.simmap(eel.tree,feed.mode,model=matrix(c(NA,1,0,NA),2,2))
mtree<-make.simmap(eel.tree,feed.mode, model= 'ARD')
mtree
mtree<-make.simmap(eel.tree,feed.mode, model= 'SYM')
make.simmap
matrix(c(0,0,1,0),2,2,byrow=TRUE)
## plot single stochastic map
plot(mtree,cols,fsize=0.4,ftype="i",lwd=2,offset=0.4,
ylim=c(-1,Ntip(eel.tree)))
runApp()
actionButton('AddModelDisBI','Add model')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
AncDiscreteBI$matrix0 <- reactive(matrix(data = as.integer(0), nrow = nStatesBI()[1], ncol = nStatesBI()[1],
dimnames = list(levels(SelectedVarDisc()),levels(SelectedVarDisc()))))
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
observeEvent(input$SubmAddModelBI == 1, {
# Submit new model
#
if (input$SubmAddModelBI == 1) {
AncDiscreteBI$modelMatrixBI <- hot_to_r(input$costuModelBI) # get values from costumizable table
# Name new model
names(AncDiscreteBI$modelMatrixBI) <- 'UserModel'
}
})
runApp()
runApp()
runApp()
runApp()
observeEvent(input$SubmAddModelBI > 0, {
# Submit new model
#
if (!is.null(input$costuModelBI)) {
AncDiscreteBI$modelMatrixBI <- hot_to_r(input$costuModelBI) # get values from costumizable table
# Name new model
names(AncDiscreteBI$modelMatrixBI) <- 'UserModel'}
})
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
# # Submit new model
AncDiscreteBI$modelMatrixBI <- hot_to_r(input$costuModelBI) # get values from costumizable table
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
if(!is.null(AncDiscreteBI$QmatrixPar)){
row.names(AncDiscreteBI$QmatrixPar) <- levels(SelectedVarDisc()) # assign name states
colnames(AncDiscreteBI$QmatrixPar) <- levels(SelectedVarDisc())
diag(AncDiscreteBI$QmatrixPar) <- -rowSums(AncDiscreteBI$QmatrixPar,na.rm = TRUE)# get values from costumizable table
}
runApp()
runApp()
fit.marginal$vv[[1]]
runApp()
runApp()
runApp()
runApp()
mtree<-make.simmap(eel.tree,feed.mode, model= matrix(c(0,0,1,0),2,2),Q="Empirical",nsim = 100 )
mtree<-make.simmap(eel.tree,feed.mode, model= matrix(c(0,0,1,0),2,2),Q="Empirical")
make.simmap(tree = eel.tree,x = feed.mode, model= matrix(c(0,0,1,0),2,2),nsim = 1,Q="Empirical")
mtree<-make.simmap(tree = eel.tree,x = feed.mode, model= 'ER',nsim = 1,Q="Empirical")
eel.tree
feed.mode
model= 'ER'
nsim = 1
model
mtree<-make.simmap(tree = eel.tree,x = feed.mode, model= 'ER')
mtree<-make.simmap(tree = eel.tree,x = feed.mode, model= 'ER',nsim = 1)
mtree<-make.simmap(tree = eel.tree,x = feed.mode, model= 'ER',nsim = 100)
mtree<-make.simmap(tree = eel.tree,x = feed.mode, model= matrix(c(0,0,1,0),2,2,byrow=TRUE),nsim = 100)
mtree<-make.simmap(tree = eel.tree,x = feed.mode, model= matrix(c(0,0,1,0),2,2,byrow=TRUE),nsim = 100,Q="empirical")
make.simmap
matrix(c(0.2,0.8),1,2,byrow=TRUE)
mtree<-make.simmap(tree = eel.tree,x = feed.mode, model= matrix(c(0,0,1,0),2,2,byrow=TRUE),nsim = 100,Q="empirical",pi=matrix(c(0.2,0.8),1,2,byrow=TRUE))
mtree<-make.simmap(tree = eel.tree,x = feed.mode, model= matrix(c(0,0,1,0),2,2,byrow=TRUE),nsim = 100,Q="empirical",pi=c(0.8,0.2))
matrix(c(0.2,0.8),1,2,byrow=TRUE)
c(matrix(c(0.2,0.8),1,2,byrow=TRUE)[1,])
runApp()
runApp()
make.simmap
runApp()
runApp()
runApp()
runApp()
AncDiscreteBI$burnin <- as.numeric(input$burninDisBI) * (AncDiscreteBI$nsim * AncDiscreteBI$sampleFreq)
runApp()
list(use.empirical=TRUE)
matrix(c(0,0,1,0),2,2,byrow=TRUE)
matrix(c(0,0,1,2),2,2,byrow=TRUE)
matrix(c(0,2,1,0),2,2,byrow=TRUE)
m <- matrix(c(0,2,1,0),2,2,byrow=TRUE)
unique(m)
m <- matrix(c(0,2,1,0),2,2,byrow=TRUE)
length(unique(m))
which(unique(m))
c(m)
unique(c(m))
unique(c(m)) !=0
length(unique(c(m)) !=0)
length(which(unique(c(m)) !=0))
unique(c(m))
c(m)[which(unique(c(m)) !=0)]
m <- matrix(c(0,1,2,0),2,2,byrow=TRUE)
unique(c(m))
c(m)[which(unique(c(m)) !=0)]
sort(c(m)[which(unique(c(m)) !=0)])
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
matrix(c(0,1,2,0,3,0),3,3,byrow=TRUE)
m <- matrix(c(0,1,2,3,0,0),3,3,byrow=TRUE)
matrix(c(0,1,2,3,0,0),3,3,byrow=TRUE)
m <- matrix(c(0,1,2,1,0,3,3,2,0),3,3,byrow=TRUE)
m
matrix(c(0,1,2,1,0,3,2,3,0),3,3,byrow=TRUE)
m <- matrix(c(0,1,2,1,0,3,2,3,0),3,3,byrow=TRUE)
length(which(unique(c(m)) !=0))
sort(c(m)[which(unique(c(m)) !=0)])
which(unique(c(m)) !=0)
c(m)
unique(c(m))
sort(unique(c(m))[which(unique(c(m)) !=0)])
runApp()
runApp()
# Submit Beta values
#
observeEvent(input$SubmBetaValuePerRateDisBI > 0,{
AncDiscreteBI$Priorpar <- list(use.empirical = TRUE,beta = c(hot_to_r(input$matBetaValuePerRateDisBI)[1,]))
})
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
